<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MathNLP Parser</title>
  <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital,wght@0,400;1,400&family=Geist:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    html, body {
      height: 100%;
    }
    body {
      background: #18181b;
      min-height: 100vh;
      margin: 0;
      font-family: 'Geist', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: #f3f3f3;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }
    .heading {
      font-family: 'Instrument Serif', serif;
      font-size: 2.2em;
      color: #fff;
      margin-top: 3em;
      margin-bottom: 2em;
      letter-spacing: 0.01em;
      text-align: center;
      font-weight: 400;
    }
    .center-box {
      width: 100%;
      max-width: 520px;
      background: #23232a;
      border: 2px solid #fff;
      border-radius: 0;
      box-shadow: 0 4px 32px rgba(0,0,0,0.18);
      padding: 1.5em 1.2em 1em 1.2em;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      margin-bottom: 2em;
    }
    .center-box textarea, .center-box .output {
      width: 100%;
      background: #18181b;
      color: #fff;
      border: 2px solid #fff;
      border-radius: 0;
      font-size: 1.1em;
      font-family: 'Geist', sans-serif;
      padding: 1em;
      min-height: 100px;
      resize: vertical;
      margin-bottom: 1em;
      box-sizing: border-box;
      transition: background 0.2s, color 0.2s;
      text-align: left;
    }
    .center-box .output {
      min-height: 100px;
      display: none;
      word-break: break-all;
      text-align: center;
      font-size: 1.2em;
    }
    .center-box .output.show {
      display: block;
    }
    .button-row {
      display: flex;
      gap: 0;
      width: 100%;
    }
    .button-row button {
      flex: 1 1 0;
      background: #18181b;
      color: #fff;
      border: 2px solid #fff;
      border-radius: 0;
      font-family: 'Geist', sans-serif;
      font-size: 1em;
      font-weight: 500;
      padding: 0.9em 0;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
      margin: 0;
    }
    .button-row button:not(:last-child) {
      border-right: none;
    }
    .button-row button:hover {
      background: #fff;
      color: #23232a;
    }
    @media (max-width: 600px) {
      .center-box {
        max-width: 98vw;
      }
    }
  </style>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
  <div class="heading">MathNLP Parser</div>
  <div class="center-box">
    <textarea id="input" placeholder="e.g., integrate x squared with respect to y"></textarea>
    <div class="output" id="output"></div>
    <div class="button-row">
      <button id="parseBtn" onclick="parseExpression()">Parse</button>
      <button id="suggestBtn" onclick="suggestExample()">Suggest</button>
    </div>
  </div>
  <script>
    const API_URL = 'http://localhost:8000/parse';
    const examples = [
      'integrate x squared with respect to y',
      'derivative of sin x with respect to x',
      'sum from i equals 1 to n of i squared',
      'limit as x approaches 0 of sin x over x',
      'partial derivative of x squared y with respect to x'
    ];
    function suggestExample() {
      const random = examples[Math.floor(Math.random() * examples.length)];
      document.getElementById('input').value = random;
      showInput();
    }
    async function parseExpression() {
      const input = document.getElementById('input').value.trim();
      const outputDiv = document.getElementById('output');
      const inputBox = document.getElementById('input');
      const parseBtn = document.getElementById('parseBtn');
      if (!input) {
        alert('Please enter a mathematical expression!');
        return;
      }
      parseBtn.disabled = true;
      parseBtn.innerText = 'Parsing...';
      inputBox.style.display = 'none';
      outputDiv.classList.remove('show');
      outputDiv.innerHTML = '';
      outputDiv.style.display = 'block';
      try {
        const response = await fetch(API_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ text: input })
        });
        const data = await response.json();
        if (response.ok) {
          outputDiv.innerHTML = `$$${data.latex}$$`;
          outputDiv.classList.add('show');
          if (window.MathJax) MathJax.typesetPromise([outputDiv]);
        } else {
          outputDiv.innerHTML = data.detail || 'Error parsing.';
          outputDiv.classList.add('show');
        }
      } catch (error) {
        outputDiv.innerHTML = 'Connection error.';
        outputDiv.classList.add('show');
      } finally {
        parseBtn.disabled = false;
        parseBtn.innerText = 'Parse';
      }
    }
    function showInput() {
      document.getElementById('output').style.display = 'none';
      document.getElementById('input').style.display = 'block';
    }
    // Allow Enter key to submit (Shift+Enter for new line)
    document.getElementById('input').addEventListener('keydown', function(e) {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        parseExpression();
      }
    });
    // Clicking output brings back input
    document.getElementById('output').addEventListener('click', showInput);
  </script>
</body>
</html>
